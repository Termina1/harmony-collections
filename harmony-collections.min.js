/* (The MIT License)
 *
 * Copyright (c) 2012 Brandon Benvie <http://bbenvie.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of this software and
 * associated documentation files (the 'Software'), to deal in the Software without restriction,
 * including without limitation the rights to use, copy, modify, merge, publish, distribute,
 * sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included with all copies or
 * substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING
 * BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY  CLAIM,
 * DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

void function(y,v,m,a,b,c,w,i,u,x,d){'use strict';var t=c.getOwnPropertyNames,s=typeof t===m&&!(a in t),n=c[a].hasOwnProperty;var e=s?c.create:function(g,b){var d=function(){};d[a]=c(g);var e=new d;if(b)for(var f in b)o(e,f,b[f]);return e};var o=s?c.defineProperty:function(a,c,b){return'value'in b&&(a[c]=b.value),a};var g=function(c,a,b){return typeof a===m&&(b=a,a=r(b).replace(/_$/,'')),o(c,a,{configurable:!0,writable:!0,value:b})};var r=function(a){return typeof a!==m?'':'name'in a?a.name:w[b].call(a).match(/^\n?function\s?(\w*)?_?\(/)[1]};var A=function(a){return function(){return z.apply(a,arguments)}};var z=w.call,B=w.apply,f=A(z),C=A(B);var j=function(){function getOwnPropertyNames(b){var a=t(b);return n.call(b,f)&&a.splice(a.indexOf(f),1),a}function j(){var a=h(),b={};this.unlock=function(f){var c=k(f);if(n.call(c,a))return c[a](b);var d=e(null,l);return o(c,a,{value:new Function('s','l',m)(b,d)}),d}}function get(a){return this.unlock(a).value}function set(a,b){this.unlock(a).value=b}var l={value:{writable:!0,value:d}},m='return function(k){if(k===s)return l}',i=e(null);var h=function(){var a=Math.random()[b](36).slice(2);return a in i?h():i[a]=a};var f=h();if(s){var k=function(a){if(n.call(a,f))return a[f];if(!c.isExtensible(a))throw new TypeError('Object must be extensible');var b=e(null);return o(a,f,{value:b}),b};g(c,getOwnPropertyNames)}else{var p=function(a){function toString(){return a}return toString[b]=toString}(c[a][b]+'');var k=function(a){function toString(){return c.call(this)}if(n.call(a,b)&&f in a[b])return a[b][f];if(!(b in a))throw new Error("Can't store values for "+a);var c=a[b];return a[b]=toString,toString[b]=p,toString[f]={}}}return g(j[a],get),g(j[a],set),j}();var q=function(){function toString(){return b[0]+r(this)+b[1]}var b=(''+c).split('Object');g(toString,toString);var d=function(b){var c=b.shift();void function(){function toString(){return a}var a='[object '+r(c)+']';b.push(toString)}();for(var d=0;d<b.length;d++)g(b[d],toString),g(c[a],b[d]);return g(c,toString),c};return function(a,c){if(a in u)return u[a];var b=new j;return u[a]=d(c(function(d,e){var c=b.unlock(d);if(c.value)throw new TypeError('Object is already a '+a);c.value=e},function(d){var c=b.unlock(d).value;if(!c)throw new TypeError(a+' is not generic');return c}))}}();var p=function(a,b){a!==null&&typeof a===v&&typeof a.forEach===m&&a.forEach(function(d,c){d instanceof Array&&d.length===2?b(a[c][0],a[c][1]):b(a[c],c)})};var h=q('WeakMap',function(e,b){function h(a){if(this===i||this==null||this===g)return new h(a);e(this,new j);var b=this;a&&p(a,function(a,c){f(set,b,a,c)})}function get(a){c(a);var e=b(this).get(a);return e===x?d:e}function set(a,e){c(a),b(this).set(a,e===d?x:e)}function has(a){return c(a),b(this).get(a)!==d}function delete_(a){c(a);var e=b(this);return e.get(a)===d?!1:(e.set(a,d),!0)}var g=h[a];var c=function(a){if(a==null||typeof a!==v&&typeof a!==m)throw new TypeError('Invalid WeakMap key')};return[h,get,set,has,delete_]}),l=q('HashMap',function(m,b){function l(a){if(this===i||this==null||this===o)return new l(a);m(this,{size:0,0:e(null),1:e(null),2:e(null)});var b=this;a&&p(a,function(a,c){f(set,b,a,c)})}function get(a){return b(this)[g(a)][c(a)]}function set(a,f){var d=b(this),e=d[g(a)];a=c(a),a in e||d.size++,e[a]=f}function has(a){return c(a)in b(this)[g(a)]}function delete_(a){var d=b(this);return data=d[g(a)],a=c(a),a in data?(delete data[a],d.size--,!0):!1}function size(){return b(this).size}function forEach(g,c){var d=b(this);c=c==null?i:c;for(var a=0;a<3;a++)for(var e in d[a])f(g,c,d[a][e],q(a,e),this)}var o=l[a],h=0,j=1,d=2,n={'true':!0,'false':!1,'null':null,0:-0};if('toString'in e(null)){var c=function(a){return typeof a===y?'_'+a:''+a};var k=function(a){return a.slice(1)}}else var k=c=function(a){return a};var q=function(b,a){switch(b){case h:return k(a);case j:return+a;case d:return n[a]}};var g=function(a){if(a==null)return d;switch(typeof a){case'boolean':return d;case y:return h;case'number':return a===0&&Infinity/a===-Infinity?d:j;default:throw new TypeError('Invalid HashMap key')}};return[l,get,set,has,delete_,size,forEach]}),k=q('Map',function(o,b){function k(a){if(this===i||this==null||this===n)return new k(a);o(this,{0:new l,1:new h,keys:[],values:[]});var b=this;a&&p(a,function(a,c){f(set,b,a,c)})}function get(a){var c=b(this),d=e(a);return c.values[j[d].call(c[d],a)]}function set(c,h){var a=b(this),f=e(c),g=j[f].call(a[f],c);g===d?(q[f].call(a[f],c,a.keys.length),a.keys.push(c),a.values.push(h)):(a.keys[g]=c,a.values[g]=h)}function has(a){var c=e(a);return r[c].call(b(this)[c],a)}function delete_(f){var a=b(this),c=e(f),g=j[c].call(a[c],f);return g===d?!1:(s[c].call(a[c],f),a.keys.splice(g,1),a.values.splice(g,1),!0)}function size(){return b(this).keys.length}function forEach(g,a){var d=b(this),e=d.keys,h=d.values;a=a==null?i:a;for(var c=0,j=e.length;c<j;c++)f(g,a,h[c],e[c],this)}var n=k[a],g=h[a],c=l[a],j=[c.get,g.get],q=[c.set,g.set],r=[c.has,g.has],s=[c['delete'],g['delete']];var e=function(a){return a!=null&&typeof a===v||typeof a===m?1:0};return[k,get,set,has,delete_,size,forEach]});Set=q('Set',function(h,c){function Set(a){if(this===i||this==null||this===e)return new Set(a);h(this,new k);var b=this;a&&p(a,function(c,a){f(add,b,a)})}function add(a){m.call(c(this),a,a)}function has(a){return l.call(c(this),a)}function delete_(a){return g.call(c(this),a)}function size(){return d.call(c(this))}function forEach(a,b){var d=0,e=this;j.call(c(this,function(b){f(a,this,b,d++,e)},b))}var e=Set[a],b=k[a],d=b.size,j=b.forEach,n=b.get,m=b.set,l=b.has,g=b['delete'];return[Set,add,has,delete_,size,forEach]})}('string','object','function','prototype','toString',Object,Function.prototype,Function('return this')(),typeof exports==='undefined'?this:exports,{})
