/* (The MIT License)
 *
 * Copyright (c) 2012 Brandon Benvie <http://bbenvie.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of this software and
 * associated documentation files (the 'Software'), to deal in the Software without restriction,
 * including without limitation the rights to use, copy, modify, merge, publish, distribute,
 * sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included with all copies or
 * substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING
 * BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY  CLAIM,
 * DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

void function(b,a,q,o,g,n,c){'use strict';var p=function(a){return typeof a==='function'&&!('prototype'in a)};var l=p(a.getOwnPropertyNames);var h=a.prototype.hasOwnProperty;var e=l?a.create:function(f,b){var c=function(){};c.prototype=a(f);var d=new c;if(b)for(var e in b)j(d,e,b[e]);return d};var j=l?a.defineProperty:function(a,c,b){return'value'in b&&(a[c]=b.value),a};var d=function(c,a,b){return typeof a==='function'&&(b=a,a=m(b).replace(/_$/,'')),j(c,a,{configurable:!0,writable:!0,value:b})};var m=function(a){return typeof a!=='function'?'':'name'in a?a.name:q[b].call(a).match(/^\n?function\s?(\w*)?_?\(/)[1]};var k=function(a,d,c){c=c||a;if(a!==null&&typeof a==='object')if(a instanceof Array)for(var b=0;b<a.length;b++)a[b]instanceof Array&&a[b].length===2?d.call(c,a[b][0],a[b][1]):d.call(c,a[b],b);else if(a.forEach)a.forEach(d,c);else for(var e in a)h.call(a,e)&&d.call(c,a[e],e)};var f=function(){function getOwnPropertyNames(b){var a=n(b);return h.call(b,g)&&a.splice(a.indexOf(g),1),a}function f(){var a=i(),b={};this.unlock=function(f){var c=m(f);if(h.call(c,a))return c[a](b);var d=e(null,o);return j(c,a,{value:new Function('s','l',p)(b,d)}),d}}function get(a){return this.unlock(a).value}function set(a,b){this.unlock(a).value=b}var n=a.getOwnPropertyNames,o={value:{writable:!0,value:c}},p='return function(k){if(k===s)return l}',k=e(null);var i=function(){var a=Math.random().toString(36).slice(2);return a in k?i():k[a]=a};var g=i();if(l){var m=function(b){if(h.call(b,g))return b[g];if(!a.isExtensible(b))throw new Error('Collections for non-extensible objects not implemented');var c=e(null);return j(b,g,{value:c}),c};d(a,getOwnPropertyNames)}else{var q=function(a){function toString(){return a}return toString[b]=toString}(a.prototype[b]+'');var m=function(a){function toString(){return c.call(this)}if(h.call(a,b)&&g in a[b])return a[b][g];if(!(b in a))throw new Error('Can\'t store values for '+a);var c=a[b];return a[b]=toString,toString[b]=q,toString[g]={}}}return d(f.prototype,get),d(f.prototype,set),f}();var i=function(){function toString(){return b[0]+m(this)+b[1]}var b=(''+a).split('Object');d(toString,toString);var c=function(a){var b=a.shift();void function(){function toString(){return c}var c='[object '+m(b)+']';a.push(toString)}();for(var c=0;c<a.length;c++)d(a[c],toString),d(b.prototype,a[c]);return d(b,toString),b};return function(a,d){if(a in g)return;var b=new f;g[a]=c(d(function(a,c){b.unlock(a).value=c},function(d){var c=b.unlock(d).value;if(!c)throw new TypeError(a+' is not generic.');return c}))}}();i('WeakMap',function(d,a){function WeakMap(){if(!(this instanceof WeakMap))return new WeakMap;d(this,new f)}function get(d){b(d);var e=a(this).get(d);return e===n?c:e}function set(d,e){b(d),a(this).set(d,e===c?n:e)}function has(d){return b(d),a(this).get(d)!==c}function delete_(d){b(d);var e=a(this);return e.get(d)===c?!1:(e.set(d,c),!0)}var b=function(a){if(a==null||typeof a!=='object'&&typeof a!=='function')throw new TypeError('WeakMap keys must be objects')};return[WeakMap,get,set,has,delete_]}),i('HashMap',function(i,a){function HashMap(a){if(!(this instanceof HashMap))return new HashMap;i(this,{size:0,0:e(null),1:e(null),2:e(null)}),k(a,function(a,b){this.set(b,a)},this)}function get(c){return a(this)[d(c)][b(c)]}function set(c,g){var e=a(this),f=e[d(c)];c=b(c),c in f||e.size++,f[c]=g}function has(c){return b(c)in a(this)[d(c)]}function delete_(c){var e=a(this);return hash=e[d(c)],c=b(c),c in hash?(delete hash[c],e.size--,!0):!1}function size(){return a(this).size}function forEach(f,c){var d=a(this);c=c==null?o:c;for(var b=0;b<3;b++)for(var e in d[b])f.call(c,d[b][e],l(b,e),this)}var g=0,f=1,c=2;var j={'true':!0,'false':!1,'null':null,0:-0};if('toString'in e(null)){var b=function(a){return typeof a==='string'?'_'+a:''+a};var h=function(a){return a.slice(1)}}else var h=b=function(a){return a};var l=function(b,a){switch(b){case g:return h(a);case f:return+a;case c:return j[a]}};var d=function(a){if(a==null)return c;switch(typeof a){case'boolean':return c;case'string':return g;case'number':return a===0&&Infinity/a===-Infinity?c:f;default:throw new TypeError('HashMap keys must be primitive')}};return[HashMap,get,set,has,delete_,size,forEach]}),i('Map',function(d,a){function Map(a){if(!(this instanceof Map))return new Map;d(this,{0:new g.HashMap,1:new g.WeakMap,keys:[],values:[]}),k(a,function(a,b){this.set(b,a)},this)}function get(c){var d=a(this);return d.values[d[b(c)].get(c)]}function set(e,g){var d=a(this),h=d[b(e)],f=h.get(e);f===c?(h.set(e,d.keys.length),d.keys.push(e),d.values.push(g)):(d.keys[f]=e,d.values[f]=g)}function has(c){return a(this)[b(c)].has(c)}function delete_(d){var e=a(this),g=e[b(d)],f=g.get(d);return f===c?!1:(g['delete'](d),e.keys.splice(f,1),e.values.splice(f,1),!0)}function size(){return a(this).keys.length}function forEach(f,b){var d=a(this),e=d.keys,g=d.values;b=b==null?o:b;for(var c=0,h=e.length;c<h;c++)f.call(b,g[c],e[c])}var b=function(a){return a!=null&&typeof a==='object'||typeof a==='function'?1:0};return[Map,get,set,has,delete_,size,forEach]}),i('Set',function(b,a){function Set(a){if(!(this instanceof Set))return new Set;b(this,new g.Map),k(a,this.add,this)}function add(b){a(this).set(b,b)}function has(b){return a(this).has(b)}function delete_(b){return a(this)['delete'](b)}function size(){return a(this).size()}function forEach(b,c){var d=0;a(this).forEach(function(a){b.call(this,a,d++)},c)}return[Set,add,has,delete_,size,forEach]})}('toString',Object,Function.prototype,Function('return this')(),typeof exports==='undefined'?this:exports,{})

