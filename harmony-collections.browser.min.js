// Original by Gozala @ https://gist.github.com/1269991
// Updated by Raynos @ https://gist.github.com/1638059
// Modified and expanded to [Map, Hash, Set] by Benvie @ https://github.com/Benvie
!function(exports,global){"use strict";var origGOPN=Object.getOwnPropertyNames,hasOwn=Object.prototype.hasOwnProperty;function isObject(o){return Object(o)===o}var defineMethods=function(){var desc={configurable:!0,writable:!0,enumerable:!1};return function(o,v){return Array.isArray(v)?v.forEach(function(v){desc.value=v,Object.defineProperty(o,v.name,desc)}):(desc.value=v,Object.defineProperty(o,v.name,desc)),desc.value=null,o}}(),fakeNative=function(){var code=(Object+"").split("Object"),toString=(new Function('return function toString(){ return "'+code[0]+'"+this.name+"'+code[1]+'" }'))();function fakeNative(fn){return defineMethods(fn,toString)}return fakeNative(toString),fakeNative}();defineMethods(Object,function getOwnPropertyNames(o){var props=origGOPN(o);return hasOwn.call(o,"valueOf")&&o.valueOf.ns&&props.splice(props.indexOf("valueOf"),1),props}),fakeNative(Object.getOwnPropertyNames);function glue(methods){var Ctor=methods.shift();return defineMethods(Ctor.prototype,methods),methods.forEach(fakeNative),fakeNative(Ctor)}function namespace(obj,key){var store=Object.create(null),origVO=obj.valueOf||Object.prototype.valueOf;return defineMethods(obj,function valueOf(value){return value!==key?origVO.apply(this,arguments):store}),obj.valueOf.ns=!0,store}function Name(){var key=this;return function(obj){var store=obj.valueOf(key);return store!==obj?store:namespace(obj,key)}}var WeakMap=function(){var weakmaps=new Name;return glue([function WeakMap(){if(this instanceof WeakMap)weakmaps(this).lookup=new Name;else return new WeakMap},function get(key){return weakmaps(this).lookup(key).value},function set(key,value){return weakmaps(this).lookup(key).value=value},function has(key){return hasOwn.call(weakmaps(this).lookup(key),"value")},function delet\u0065(key){var store=weakmaps(this).lookup(key);return hasOwn.call(store,"value")?(delete store.value,!0):!1}])}(),Hash=function(){var hashes=new WeakMap;return glue([function Hash(){if(this instanceof Hash)hashes.set(this,Object.create(null));else return new Hash},function get(key){return hashes.get(this)[key]},function set(key,value){return hashes.get(this)[key]=value},function has(key){return key in hashes.get(this)},function delet\u0065(key){var hash=hashes.get(this),has=key in hash;return key in hash?(delete hash[key],!0):!1}])}(),Map=function(){var maps=new WeakMap;return glue([function Map(){if(this instanceof Map)maps.set(this,[new Hash,new Name]);else return new Map},function get(key){return maps.get(this)[isObject(key)].get(key)},function set(key,value){return maps.get(this)[isObject(key)].set(key,value)},function has(key){return maps.get(this)[isObject(key)].has(key)},function delet\u0065(key){return maps.get(this)[isObject(key)].delete(key)}])}(),Set=function(){var sets=new WeakMap;return glue([function Set(){if(this instanceof Set)sets.set(this,new Map);else return new Set},function add(key){return sets.get(this).set(key,!0)},function has(key){return sets.get(this).has(key)},function delet\u0065(key){return sets.get(this).delete(key)}])}();"Hash"in exports||(exports.Hash=Hash),"Map"in exports||(exports.Map=Map),"Set"in exports||(exports.Set=Set),"WeakMap"in exports||(exports.WeakMap=WeakMap)}(typeof module=="undefined"?this:module.exports,(new Function("return this"))())